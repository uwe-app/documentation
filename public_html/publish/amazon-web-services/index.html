<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><title>Amazon Web Services</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="content-security-policy" content="default-src data: &#x27;self&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;;"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Publish a site to Amazon Web Services"><meta name="commit" content="29c6d3d29ee514ded0f5df919016043c64caa579"><meta name="generator" content="uwe/0.43.4"><meta name="version" content="1.0.0"><meta name="author" content="Muji (https://tmpfs.org/)"><meta property="og:description" content="Publish a site to Amazon Web Services"><meta property="og:image" content="https://uwe.app/assets/img/social.jpg"><meta property="og:site_name" content="UWE / Universal Web Editor"><meta property="og:title" content="Amazon Web Services"><meta property="og:type" content="website"><meta property="og:url" content="https://uwe.app/docs/publish/amazon-web-services/"><link rel="stylesheet" href="../../../assets/plugins/font::inter::regular/plugins/regular/styles/fonts.css"><link rel="stylesheet" href="../../../assets/plugins/std::core/styles/standard.css"><link rel="stylesheet" href="../../../assets/plugins/std::crumbtrail/styles/crumbtrail.css"><link rel="stylesheet" href="../../../assets/plugins/std::menu/styles/menu.css"><link rel="stylesheet" href="../../../assets/plugins/std::note/styles/note.css"><link rel="stylesheet" href="../../../assets/plugins/std::sidebar/styles/sidebar.css"><link rel="icon" href="data:image/gif;base64,R0lGODlhEAAQAAAAACwAAAAAAQABAAACASgAOw=="><link rel="stylesheet" href="../../../assets/styles/main.css"><link rel="manifest" href="../../../app.webmanifest"><link rel="canonical" href="https://uwe.app/docs/publish/amazon-web-services/"></head><body><input id="sidebar-toggle" type="checkbox"><aside id="sidebar"><header><a href="../../" title="Home">Home</a><label for="sidebar-toggle"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></label></header><nav><p><a href="../../" title="Documentation">Docs</a> / <a href="../../publish/" title="Publish">Publish</a></p><ul><li><a href="../../publish/self-hosting/" title="Self Hosting">Self Hosting</a></li><li class='selected'><a href="../../publish/amazon-web-services/" title="Amazon Web Services">Amazon Web Services</a></li></ul></nav></aside><main><header><a href="../../" title="Home">UWE</a><label for="sidebar-toggle"><span>Menu</span>&nbsp;<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></label></header><article><h1 id="amazon-web-services">Amazon Web Services</h1><nav class="crumbtrail"><a href="../../../" title="Universal Web Editor">Home</a><a href="../../" title="Documentation and developer reference">Documentation</a><a href="../" title="Publish the site">Publish</a>Amazon Web Services</nav><h2 id="credentials">Credentials</h2><p>Before you can publish using <a href="https://aws.amazon.com/">Amazon Web Services</a> you must configure credentials. We use the standard profile credentials to publish so if you have used the <code>aws</code> command line tools this should be familiar.</p><p>Edit the <code>~/.aws/credentials</code> file to set the access key and secret access key:</p><pre><code><span style="color:#657b83;">[</span><span style="color:#b58900;">example-credentials</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">aws_access_key_id </span><span style="color:#657b83;">= </span><span style="color:#657b83;">XXXX</span><span style="color:#657b83;">
</span><span style="color:#268bd2;">aws_secret_access_key </span><span style="color:#657b83;">= </span><span style="color:#657b83;">XXXX</span><span style="color:#657b83;">
</span></code></pre><p>We recommend that the credentials you assign have access to S3 and Cloudfront.</p><h2 id="settings">Settings</h2><p>Now you can configure the publish settings in <code>site.toml</code> to reference those credentials:</p><pre><code><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">region </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">us-east-1</span><span style="color:#839496;">&quot;
</span><span style="color:#268bd2;">credentials </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">example-credentials</span><span style="color:#839496;">&quot;
</span><span style="color:#657b83;">
</span><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">.</span><span style="color:#b58900;">environments</span><span style="color:#657b83;">.</span><span style="color:#b58900;">stage</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">bucket </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">stage.example.com</span><span style="color:#839496;">&quot;
</span><span style="color:#657b83;">
</span><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">.</span><span style="color:#b58900;">environments</span><span style="color:#657b83;">.</span><span style="color:#b58900;">production</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">bucket </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">example.com</span><span style="color:#839496;">&quot;
</span></code></pre><p>You need to ensure that the region matches where your buckets are located and the buckets must already exist then you can publish an environment like this:</p><pre><code>uwe publish stage
</code></pre><p>It is not required to have a <code>stage</code> environment but is recommended so you can check the published site before going live. Once you have verified the staging site; to publish to production just specify the <code>production</code> environment:</p><pre><code>uwe publish production
</code></pre><h2 id="keep-remote">Keep Remote</h2><p>Publishing to an AWS S3 bucket is a <em>sync operation</em> so files that do not exist locally will be deleted from the remote bucket when the <code>publish</code> command runs. Normally this is what you want if the bucket is <strong>only</strong> being used for static website hosting however if you are storing other files in the bucket publishing would delete those files as they are not part of the website. In this situation you should use the <code>keep-remote</code> option for the environment settings, for example:</p><pre><code><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">.</span><span style="color:#b58900;">environments</span><span style="color:#657b83;">.</span><span style="color:#b58900;">production</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">bucket </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">example.com</span><span style="color:#839496;">&quot;
</span><span style="color:#268bd2;">keep-remote </span><span style="color:#657b83;">= </span><span style="color:#b58900;">true
</span></code></pre><p>When <code>keep-remote</code> is enabled files are not deleted from the bucket when publishing which means that you will need to remove stale website files manually.</p><p>An example of this is the <a href="https://releases.uwe.app">releases web page</a> which is a bucket containing binary executables for the software releases and an index page showing the available releases. The <a href="https://github.com/uwe-app/releases-website/">releases website</a> does not delete the remote files otherwise the executables which are published separately would be removed!</p><h2 id="prefix">Prefix</h2><p>If no bucket is given then the top-level <code>host</code> is used and you can set a <code>prefix</code> to publish into different locations in the bucket.</p><div class="note warn"><span class="label">warn</span><p>Be aware that this configuration has issues with trailing slash redirects when proxied via Cloudfront so we recommend a separate bucket per environment.</p></div><pre><code><span style="color:#268bd2;">host </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">example.com</span><span style="color:#839496;">&quot;
</span><span style="color:#657b83;">
</span><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">region </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">us-east-1</span><span style="color:#839496;">&quot;
</span><span style="color:#268bd2;">credentials </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">example-credentials</span><span style="color:#839496;">&quot;
</span><span style="color:#657b83;">
</span><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">.</span><span style="color:#b58900;">environments</span><span style="color:#657b83;">.</span><span style="color:#b58900;">stage</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">prefix </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">stage</span><span style="color:#839496;">&quot;
</span><span style="color:#657b83;">
</span><span style="color:#657b83;">[</span><span style="color:#b58900;">publish</span><span style="color:#657b83;">.</span><span style="color:#b58900;">aws</span><span style="color:#657b83;">.</span><span style="color:#b58900;">environments</span><span style="color:#657b83;">.</span><span style="color:#b58900;">production</span><span style="color:#657b83;">]
</span><span style="color:#268bd2;">prefix </span><span style="color:#657b83;">= </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">production</span><span style="color:#839496;">&quot;
</span></code></pre><p><a href=".." title="Publish">Back to Publish</a></p></article><footer><div><p>Last updated Sat Jan  9 2021</p><p><a href="https://uwe.app" title="Made by Universal Web Editor" style="text-decoration: none; font-size: 12px;">MADE BY UWE</a></p></div></footer></main><script src="../../../assets/plugins/std::sidebar/scripts/sidebar.js"></script><noscript>For a better experience please enable Javascript</noscript></body></html>