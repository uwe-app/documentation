<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><title>Build Tools</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Add external build tools"><meta name="commit" content="3cd9a97e769829d13d00f66b2b3b99f58729133c"><meta name="generator" content="uwe/0.48.12"><meta name="version" content="1.0.0"><meta name="author" content="Muji (https://tmpfs.org/)"><meta property="og:description" content="Add external build tools"><meta property="og:image" content="https://uwe.app/assets/img/social.jpg"><meta property="og:site_name" content="UWE / Universal Web Editor"><meta property="og:title" content="Build Tools"><meta property="og:type" content="website"><meta property="og:url" content="https://uwe.app/docs/in-depth/build-tools/"><link rel="stylesheet" href="../../../assets/plugins/std::alert/styles/alert.css"><link rel="stylesheet" href="../../../assets/plugins/std::crumbtrail/styles/crumbtrail.css"><link rel="stylesheet" href="../../../assets/plugins/std::menu/styles/menu.css"><link rel="stylesheet" href="../../../assets/plugins/std::sidebar/styles/sidebar.css"><link rel="stylesheet" href="../../../assets/plugins/uwe::brand::main/site/assets/styles/standard.css"><link rel="stylesheet" href="../../../assets/plugins/uwe::brand::syntax/site/assets/styles/syntax.css"><link rel="icon" href="data:image/gif;base64,R0lGODlhEAAQAAAAACwAAAAAAQABAAACASgAOw=="><link rel="stylesheet" href="../../../assets/styles/main.css"><link rel="manifest" href="../../../app.webmanifest"><link rel="canonical" href="https://uwe.app/docs/in-depth/build-tools/"></head><body><input id="sidebar-toggle" type="checkbox" checked><aside id="sidebar"><div><header><label for="sidebar-toggle"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></label></header><section><nav><p><a href="../../" title="Documentation">Docs</a> / <a href="../../in-depth/" title="In-Depth">In-Depth</a></p><ul><li><a href="../../in-depth/build-profiles/" title="Build Profiles">Build Profiles</a></li><li><a href="../../in-depth/hooks/" title="Hooks">Hooks</a></li><li class='selected'><a href="../../in-depth/build-tools/" title="Build Tools">Build Tools</a></li><li><a href="../../in-depth/test-options/" title="Test Options">Test Options</a></li><li><a href="../../in-depth/json-templates/" title="JSON Templates">JSON Templates</a></li><li><a href="../../in-depth/link-catalog/" title="Link Catalog">Link Catalog</a></li><li><a href="../../in-depth/ignores/" title="Ignores">Ignores</a></li><li><a href="../../in-depth/error-page/" title="Error Page">Error Page</a></li><li><a href="../../in-depth/strict-mode/" title="Strict Mode">Strict Mode</a></li><li><a href="../../in-depth/parallel-builds/" title="Parallel Builds">Parallel Builds</a></li><li><a href="../../in-depth/virtual-hosts/" title="Virtual Hosts">Virtual Hosts</a></li></ul></nav></section><footer><p><a
  target="_blank"
  href="https://github.com/uwe-app/website/edit/main/site/docs/in-depth/build-tools.md"
   title="Edit on Github">Edit on Github</a></p><small><a href="https://uwe.app" title="Made by Universal Web Editor" style="text-decoration: none; font-size: 12px;">MADE BY UWE</a> (uwe/0.48.12)</small></footer></div></aside><main><header><a href="../../" title="UWE">UWE</a><label for="sidebar-toggle"><span>Menu</span>&nbsp;<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></label></header><article><h1 id="build-tools">Build Tools</h1><nav class="crumbtrail"><a href="../../../" title="Universal Web Editor">UWE</a><a href="../../" title="Documentation and developer reference">Documentation</a><a href="../" title="Universal Web Editor">In-Depth</a>Build Tools
</nav><p>The <a href="../../tutorials/using-javascript-transpiler/" title="Using Javascript Transpiler">javascript transpiler</a> tutorial shows the basic steps for adding an external build tool using a <a href="../../in-depth/hooks/" title="Hooks">hook</a>.</p><p>Here we look in more detail at what happens under the hood when integrating a Javascript transpiler or CSS preprocessor; see the <a href="https://github.com/uwe-app/cookbook/tree/main/build" title="Build Tools">build tools cookbook</a> for source code.</p><ul><li><a href="#quick-start">Quick Start</a> Use a build tool blueprint</li><li><a href="#general-steps">General Steps</a> General steps for adding build tools
<ul><li><a href="#modules">Modules</a> Dependencies should go in the project root</li><li><a href="#sources">Sources</a> Source file location</li><li><a href="#configuration">Configuration</a> Configuration file location</li><li><a href="#site-settings">Site Settings</a><ul><li><a href="#hook">Hook</a> Add a hook to the site settings</li><li><a href="#paths">Paths</a> Set the script and style paths
<ul><li><a href="#script">Script</a> Set the main script for the site</li><li><a href="#style">Style</a> Set the main stylesheet for the site</li></ul></li></ul></li><li><a href="#production">Production</a> Optimizations for release builds</li></ul></li><li><a href="#run">Run</a> Compile with live reload or for a production release</li></ul><h2 id="quick-start">Quick Start</h2><p>To quickly try out a build tool install from a blueprint like this:</p><pre><code>uwe new webpack-project cookbook::build::webpack
cd webpack-project
npm install
uwe dev --exec
</code></pre><h2 id="general-steps">General Steps</h2><p>To integrate with an external build tool add a <a href="../../in-depth/hooks/" title="Hooks">hook</a> which runs whenever a website is compiled; each build tool also runs the hook when build source files are changed and live reload is enabled (<code>uwe dev --exec</code>).</p><h3 id="modules">Modules</h3><p>For <a href="https://nodejs.org/">Node</a> based tools <code>package.json</code> and <code>node_modules</code> should be in the project root.</p><h3 id="sources">Sources</h3><p>Source files should go in the <code>site</code> directory so they can trigger a live reload and use an <code>.ignore</code> file to exclude sources from the website build.</p><h3 id="target">Target</h3><p>Build tools executed via hooks should write build products to the <code>BUILD_TARGET</code> environment variable which is automatically exposed to the command when a hook executes and points to the output directory for the current build. The <a href="../../in-depth/hooks/" title="Hooks">hooks</a> documentation has more information about the environment variables available to build tools.</p><p>Do <strong>not write build products</strong> to the <code>site</code> directory otherwise you may <strong>create an infinite loop</strong> executing the hook!</p><h3 id="configuration">Configuration</h3><p>Configuration files for build tools should go in the project root outside of the <code>site</code> directory unless they should trigger a live reload.</p><p>If a configuration file should trigger a hook to be run when files change it can go in the <code>site</code> directory; for example the <a href="https://tailwindcss.com/">tailwind</a> build tool needs to rebuild the stylesheet when the configuration file changes (see the <a href="https://github.com/uwe-app/cookbook/tree/main/build/tailwind-postcss/">tailwind-postcss</a> example project).</p><h2 id="site-settings">Site Settings</h2><h3 id="hook">Hook</h3><p>The hook setting in <code>site.toml</code> runs the build script:</p><pre><code class="language-toml code"><span class="source toml"><span class="punctuation definition table array begin toml">[[</span><span class="meta tag table array toml"><span class="entity name table toml">hook</span></span><span class="punctuation definition table array end toml">]]</span>
<span class="meta tag key toml"><span class="entity name tag toml">command</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>npm<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">args</span></span> <span class="punctuation definition key-value toml">=</span> <span class="punctuation definition array begin toml">[</span><span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>run<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation separator array toml">,</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>build<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation definition array end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">files</span></span> <span class="punctuation definition key-value toml">=</span> <span class="punctuation definition array begin toml">[</span><span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>src/*.js<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation definition array end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">watch</span></span> <span class="punctuation definition key-value toml">=</span> <span class="constant language toml">true</span>
</span></code></pre><p>The list of <code>files</code> is important to trigger the hook again when live reload is enabled; paths in the <code>files</code> list are resolved relative to the <code>site</code> directory.</p><h3 id="paths">Paths</h3><p>The compiler cannot automatically detect the main script and styles for the website as they are generated dynamically and put directly into the build target so we need to add these settings to <code>site.toml</code> so that the main script and styles are embedded on every page.</p><p>Note that the main script and style for the website should configure the <code>dynamic</code> flag to indicate that the file is generated dynamically and bypass the compiler check that the file exists.</p><h4 id="script">Script</h4><pre><code class="language-toml code"><span class="source toml"><span class="punctuation definition table begin toml">[</span><span class="meta tag table toml"><span class="entity name table toml">script</span></span><span class="punctuation definition table end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">src</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>/assets/scripts/main.js<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">dynamic</span></span> <span class="punctuation definition key-value toml">=</span> <span class="constant language toml">true</span>
</span></code></pre><p>Script settings accept all the attributes of the <code>&lt;script&gt;</code> element so if you are compiling to ES modules you should specify the <code>type</code>:</p><pre><code class="language-toml code"><span class="source toml"><span class="meta tag key toml"><span class="entity name tag toml">src</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>/assets/scripts/main.js<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">type</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>module<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">dynamic</span></span> <span class="punctuation definition key-value toml">=</span> <span class="constant language toml">true</span>
</span></code></pre><h4 id="style">Style</h4><p>The main stylesheet that would be loaded for all pages also needs to be <code>dynamic</code> when using a build tool that compiles stylesheets:</p><pre><code class="language-toml code"><span class="source toml"><span class="punctuation definition table begin toml">[</span><span class="meta tag table toml"><span class="entity name table toml">style</span></span><span class="punctuation definition table end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">src</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>/assets/styles/main.css<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">dynamic</span></span> <span class="punctuation definition key-value toml">=</span> <span class="constant language toml">true</span>
</span></code></pre><h2 id="production">Production</h2><p>The compiler will automatically set <code>NODE_ENV=production</code> for release builds (<code>uwe build --exec</code> or <code>uwe server --exec</code>) and we recommend using this environment variable to add production optimizations in build tool configuration files (see an example in <a href="https://github.com/uwe-app/cookbook/tree/main/build/tailwind-postcss/postcss.config.js">postcss.config.js</a>).</p><p>For some build tools this may not be possible in which case you can set a hook just for the release <a href="../../in-depth/build-profiles/" title="Build Profiles">build profiles</a>; for example:</p><pre><code class="language-toml code"><span class="source toml"><span class="punctuation definition table array begin toml">[[</span><span class="meta tag table array toml"><span class="entity name table toml">hook</span></span><span class="punctuation definition table array end toml">]]</span>
<span class="meta tag key toml"><span class="entity name tag toml">command</span></span> <span class="punctuation definition key-value toml">=</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>npm<span class="punctuation definition string end toml">&quot;</span></span>
<span class="meta tag key toml"><span class="entity name tag toml">args</span></span> <span class="punctuation definition key-value toml">=</span> <span class="punctuation definition array begin toml">[</span><span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>run<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation separator array toml">,</span> <span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>build-production<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation definition array end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">profiles</span></span> <span class="punctuation definition key-value toml">=</span> <span class="punctuation definition array begin toml">[</span><span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>release<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation definition array end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">files</span></span> <span class="punctuation definition key-value toml">=</span> <span class="punctuation definition array begin toml">[</span><span class="string quoted double basic toml"><span class="punctuation definition string begin toml">&quot;</span>src/*.js<span class="punctuation definition string end toml">&quot;</span></span><span class="punctuation definition array end toml">]</span>
<span class="meta tag key toml"><span class="entity name tag toml">watch</span></span> <span class="punctuation definition key-value toml">=</span> <span class="constant language toml">true</span>
</span></code></pre><nav class="next-prev"><div class="prev-page">
  &#x27f5;&nbsp;Previous: <a href="../../in-depth/hooks/" title="Hooks">Hooks</a></div><div class="next-page">
  Next: <a href="../../in-depth/test-options/" title="Test Options">Test Options</a>&nbsp;&#x27f6;
</div></nav></article><footer><div><p>Last updated Thu Feb 11 2021</p><p><a href="https://uwe.app" title="Made by Universal Web Editor" style="text-decoration: none; font-size: 12px;">MADE BY UWE</a></p></div></footer></main></body></html>